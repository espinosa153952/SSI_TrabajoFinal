Vulnerabilidades / vectores explotados en The Planets: Mercury

Inyección SQL (SQL Injection)

En el directorio /mercuryfacts/<id> hay un parámetro id que es vulnerable a SQL injection. 


Usan sqlmap para extraer datos del usuario (por ejemplo, las credenciales almacenadas en la base de datos mercury.users). 

Credenciales débiles / uso de contraseñas extraídas

Gracias a la inyección SQL, se obtiene la contraseña del usuario “webmaster” que se usa para conectarse vía SSH a la máquina. 

Después de SSH, se lee un fichero notes.txt (o similar) que contiene una contraseña codificada en base64 para el usuario “linuxmaster”. 

Escalada de privilegios (Privilege Escalation) mediante explotación local

Una vez con acceso como el usuario linuxmaster, se usa el comando sudo -l para ver qué comandos tiene permitidos. Según el walkthrough, el script /usr/bin/check_syslog.sh es ejecutable con sudo. 

check_syslog.sh usa tail -n 10 /var/log/syslog, lo cual es problemático. En el walkthrough se crea un symlink para engañar al script (haciendo que “tail” sea en realidad “vim”) y así invocar vim como root. Luego, con :!/bin/sh en vim, se consigue shell de root. 

Vulnerabilidad de local privilege escalation: PwnKit (CVE-2021-4034)

Se menciona, en uno de los write-ups, que se tiene un exploit para CVE-2021-4034 (conocido como PwnKit) para elevar privilegios hasta root. 


Esta vulnerabilidad afecta a pkexec de Polkit: permite que un usuario no privilegiado ejecute código con privilegios root manipulando variables de entorno. 


Según CERT-EU, esta vulnerabilidad está presente en muchas distribuciones de Linux hasta que se parchea. 

Comandos utiles:
ln -s /bin/vi tail
export PATH=.:$PATH
sudo --preserve-env=PATH /usr/bin/check_syslog.sh